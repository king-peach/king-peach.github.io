(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{391:function(s,t,a){s.exports=a.p+"assets/img/img-1.c452e17e.png"},392:function(s,t,a){s.exports=a.p+"assets/img/img-2.93611444.png"},393:function(s,t,a){s.exports=a.p+"assets/img/img-3.eaf6121e.png"},394:function(s,t,a){s.exports=a.p+"assets/img/img-4.505a5d5b.png"},395:function(s,t,a){s.exports=a.p+"assets/img/img-5.64d7852f.png"},454:function(s,t,a){"use strict";a.r(t);var n=a(25),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"前端工作流之commit规范及其配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#前端工作流之commit规范及其配置"}},[s._v("#")]),s._v(" 前端工作流之commit规范及其配置")]),s._v(" "),n("h2",{attrs:{id:"为啥要规范git-commit-规范"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#为啥要规范git-commit-规范"}},[s._v("#")]),s._v(" 为啥要规范git commit 规范?")]),s._v(" "),n("p",[s._v("当我们的项目体积日益增大以后，我们的 "),n("code",[s._v("git")]),s._v("提交量也会是很大的，如果这时候我们要对曾经的一次提交进行 "),n("code",[s._v("review")]),s._v(" 时，通过一次次的提交记录中查看我们的历史提交，是一件很痛苦的事情，因为这些提交信息都没有进行分类，而且也不确定提交信息是否准确\n"),n("br"),s._v(" "),n("br"),s._v("\n而一份好的提交记录，会将每次提交的影响范围，内容，以及涉及到的 "),n("code",[s._v("bug")]),s._v("都清晰地展示出来，且格式一直，便于查找。这样对查看代码提交记录或者审查代码的人更友好，能够更好地了解项目的生命周期以及中间出现的问题\n"),n("br"),s._v(" "),n("br"),s._v("\n在这里简单介绍下 "),n("code",[s._v("angular")]),s._v(" 规范 "),n("code",[s._v("commit message")]),s._v(" 写法：")]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("type"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("scope"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("subject"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 空一行")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("body"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 空一行")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("footer"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("br"),s._v(" "),n("ul",[n("li",[n("code",[s._v("header")]),s._v(" 部分分为 "),n("code",[s._v("type")]),s._v("、"),n("code",[s._v("scope")]),s._v("、"),n("code",[s._v("subject")]),s._v(" "),n("ol",[n("li",[n("code",[s._v("type")]),s._v("：提交类型，包括【 "),n("code",[s._v("feat")]),s._v(" | "),n("code",[s._v("fix")]),s._v(" | "),n("code",[s._v("perf")]),s._v(" | "),n("code",[s._v("refactor")]),s._v(" | "),n("code",[s._v("test")]),s._v(" | "),n("code",[s._v("revert")]),s._v(" | "),n("code",[s._v("docs")]),s._v(" | "),n("code",[s._v("ci")]),s._v(" | "),n("code",[s._v("build")]),s._v(" 】")]),s._v(" "),n("li",[n("code",[s._v("scope")]),s._v("：表示改动的文件范围，可以写模块-文件")]),s._v(" "),n("li",[n("code",[s._v("subject")]),s._v("：对这次改动的具体描述，例如：改了xxx "),n("code",[s._v("bug")]),s._v(" 或者增加了 xxx 功能")])])]),s._v(" "),n("li",[n("code",[s._v("body")]),s._v(" 部分就是写一下更详细的描述，为可选项")]),s._v(" "),n("li",[n("code",[s._v("footer")]),s._v(" 部分表示如果你的改动是破坏性的比如你写的是插件，大版本升级，把 "),n("code",[s._v("API")]),s._v(" 都改了，就需要在这里进行详细描述包括迁移说明")])]),s._v(" "),n("h2",{attrs:{id:"需要的工具及介绍"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#需要的工具及介绍"}},[s._v("#")]),s._v(" 需要的工具及介绍")]),s._v(" "),n("p",[s._v("我打算使用 "),n("code",[s._v("commitlint + husky + lint-staged")]),s._v(" 工具集来约束项目代码的提交，其中 commitlint 是用来约束 "),n("code",[s._v("git commit message")]),s._v("的，"),n("code",[s._v("husky")]),s._v("用来提供 "),n("code",[s._v("git pre-commit hook")]),s._v("做一些事情，而这里我们就是用来拦截 "),n("code",[s._v("git")]),s._v("提交信息，检测是否符合规范，然后再提交。当然在提交之前还可以进行一些其他操作，比如运行 "),n("code",[s._v("lint")]),s._v("一下项目，看是否有不合格的代码，但是每次提交前都 "),n("code",[s._v("lint")]),s._v("完整的项目，那会有点耗时，这对时间宝贵的程序员来说是不合理的，而 "),n("code",[s._v("lint-staged")]),s._v("的作用就是只 "),n("code",[s._v("lint")]),s._v("提交区的代码，这就大大的缩短了提交时间，提升效率。\n"),n("br"),s._v("如果你记不住以上提交规范，可以安装 "),n("code",[s._v("commitizen ｜cz-conventional-changelog")]),s._v("，在提交中增加表情，可以通过 "),n("code",[s._v("git-cz")]),s._v("实现\n"),n("br"),s._v("​\n"),n("br")]),s._v(" "),n("h3",{attrs:{id:"工具安装和配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#工具安装和配置"}},[s._v("#")]),s._v(" 工具安装和配置")]),s._v(" "),n("p",[s._v("首先安装一波 "),n("code",[s._v("commitlint + husky + lint-staged")]),s._v("工具集，使用npm下载依赖的同学可以使用以下命令：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" i husky@4.3.8 lint-staged @commitlint/cli @commitlint/config-conventional --dev\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("使用yarn的同学，使用以下命令：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" husky@4.3.8 lint-staged @commitlint/cli @commitlint/config-conventional -D\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("blockquote",[n("p",[s._v("由于husky6+版本存在比较大的改动，有可能存在不触发 pre-commit 的情况，所以在这里我使用相对稳定的v4.3.8\nlint-staged依赖需要运行在node v12.13.0+，所以如果安装后lint-satged报错，就需要将您的node版本升级到12.13.0或更高的版本，如果您需要多node环境切换的话，可以通过"),n("a",{attrs:{href:"https://www.runoob.com/w3cnote/nvm-manager-node-versions.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("nvm"),n("OutboundLink")],1),s._v("工具操作")])]),s._v(" "),n("p",[s._v("需要注意的是，对于commitlint不需要自定义提交规范的，可以直接下载 "),n("code",[s._v("@commitlint/config-angular")]),s._v(" 依赖代替\n"),n("br"),n("code",[s._v("@commitlint/config-conventional")]),s._v("依赖，关于 "),n("code",[s._v("angular")]),s._v(" 提交规范可以参考："),n("a",{attrs:{href:"https://github.com/angular/angular.js/blob/master/DEVELOPERS.md#-git-commit-guidelines",target:"_blank",rel:"noopener noreferrer"}},[s._v("AngularJS团队规范"),n("OutboundLink")],1),n("br"),s._v(" "),n("br"),s._v("对于大多数项目来说，"),n("code",[s._v("angular")]),s._v("团队规范应该是够用的，如果需要自定义的话，除了需要安装以上依赖以外，还需要在项目的根目录下新增"),n("code",[s._v("commitlint.config.js")]),s._v("文件，文件内容可以参考如下内容：")]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[s._v("module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@commitlint/config-conventional'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  rules"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'type-enum'")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'always'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'feat'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 新功能（feature）")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fix'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 修补bug")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'perf'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 优化 (包括功能、性能优化)")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'docs'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 文档（documentation）")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'style'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 格式（不影响代码运行的变动）")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'refactor'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 重构（即不是新增功能，也不是修改bug的代码变动）")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'test'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 增加测试")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'revert'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 回滚")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ci'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 构建过程或辅助工具的变动")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'chore'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 其他改动")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'type-empty'")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'never'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'subject-empty'")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'never'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'subject-full-stop'")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'never'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'subject-case'")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'never'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br")])]),n("p",[s._v("也可以使用命令行添加此文件：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"module.exports = {extends: ['@commitlint/config-conventional']};\"")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" commitlint.config.js\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("这种方式添加的文件内容不完整，还需要手动添加一些项，参考上述文件 "),n("code",[s._v("commitlint.config.js")]),s._v(" "),n("br"),s._v("下载完husky后还需要进行初始化，输入以下命令：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("npx "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" husky\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" set-script prepare "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"husky install"')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("运行完以后，项目根目录下就会出现一个 "),n("code",[s._v(".husky")]),s._v(" 文件夹，里面就是 "),n("code",[s._v("hook shell")]),s._v(" ，如图所示：\n"),n("br"),n("img",{attrs:{src:a(391),alt:"image.png"}}),s._v(" "),n("br"),s._v("接下来我们修改 "),n("code",[s._v(".husky")]),s._v(" 目录下的 "),n("code",[s._v("pre-commit")]),s._v(" 文件，如下所示：")]),s._v(" "),n("div",{staticClass:"language-json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[s._v("#!/bin/sh\n. "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$(dirname "')]),s._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('")/_/husky.sh"')]),s._v("\n\nnpx lint-staged\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("相应的page.json我们也需要配置一下，在 "),n("code",[s._v("script")]),s._v(" 中配置"),n("code",[s._v("lint")]),s._v("运行时：")]),s._v(" "),n("div",{staticClass:"language-json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"serve"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vue-cli-service serve --open"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"build"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vue-cli-service build"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"lint"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"eslint . --ext .js,.jsx,.ts,.tsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("在根节点下，添加"),n("code",[s._v("husky")]),s._v(" 和 "),n("code",[s._v("lint-staged")]),s._v(" 属性：")]),s._v(" "),n("div",{staticClass:"language-json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"husky"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"hooks"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"pre-commit"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lint-staged"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"commit-msg"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"commitlint -E HUSKY_GIT_PARAMS"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"lint-staged"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"*.{js,vue}"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"eslint --fix"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"git add"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[s._v("这时候，我们进行一下简单的测试，首先故意写一个错误的代码，添加并提交：\n"),n("br"),n("img",{attrs:{src:a(392),alt:"image.png"}}),s._v(" "),n("br"),s._v("项目会进行 "),n("code",[s._v("lint")]),s._v(" 出错了，这时提交失败了，我们再尝试一个提交正确的代码，但是输入不规范的"),n("code",[s._v("git commit message")]),s._v(" "),n("br"),n("img",{attrs:{src:a(393),alt:"image.png"}}),s._v(" "),n("br"),s._v("这里出现了 "),n("code",[s._v("husky")]),s._v(" 校验提交信息错误，我们再按照标准的提交方式提交\n"),n("br"),n("img",{attrs:{src:a(394),alt:"image.png"}}),s._v(" "),n("br"),n("img",{attrs:{src:a(395),alt:"image.png"}}),s._v(" "),n("br"),s._v("这次就提交成功了！\n"),n("br"),s._v("有的同学可能到这里出现husky还是无法触发的情况，可以尝试命令行：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("npx husky "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" .husky/commit-msg "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'npx --no-install commitlint --edit "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("'")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("到这里我们就配置了一个的完整监控 "),n("code",[s._v("commit")]),s._v(" 规范的环境，当然还有更加完善的方案，比如上面提到的增加 commitizen 进行commit 提示，以及 git-cz 添加表情，这块配置我就不赘述了，想了解的同学可以参考：\n"),n("br"),n("a",{attrs:{href:"https://juejin.cn/post/6934292467160514567#heading-7",target:"_blank",rel:"noopener noreferrer"}},[s._v("commit规范+commitlint+CHANGELOG自动生成一条龙服务"),n("OutboundLink")],1)]),s._v(" "),n("h3",{attrs:{id:"总结"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),n("p",[s._v("通过配置这套工具，我就可以方便地找到以前的垃圾代码，进行优化或者重构。经过这波配置，让我感受到前端工具的强大，以及前端生态中的有一批大佬为解放生产力而默默耕耘，生命在于折腾，我希望以后自己也能出个类似的工具，造福有需要的人，在前端圈发光发热🤩🤩\n"),n("br"),s._v("​\n"),n("br")])])}),[],!1,null,null,null);t.default=e.exports}}]);