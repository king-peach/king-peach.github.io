<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端工作流之commit规范及其配置 | King-peach</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="记录一些平时遇到的问题和技术难点">
    
    <link rel="preload" href="/assets/css/0.styles.5cc29924.css" as="style"><link rel="preload" href="/assets/js/app.e4cbe0ad.js" as="script"><link rel="preload" href="/assets/js/26.58159373.js" as="script"><link rel="preload" href="/assets/js/1.297c7cf7.js" as="script"><link rel="preload" href="/assets/js/7.a778d25a.js" as="script"><link rel="prefetch" href="/assets/js/10.5e77034d.js"><link rel="prefetch" href="/assets/js/11.b5e52617.js"><link rel="prefetch" href="/assets/js/12.e606bb39.js"><link rel="prefetch" href="/assets/js/13.5658aad4.js"><link rel="prefetch" href="/assets/js/14.4f22d05f.js"><link rel="prefetch" href="/assets/js/15.77a4ae07.js"><link rel="prefetch" href="/assets/js/16.37c163db.js"><link rel="prefetch" href="/assets/js/17.cae1447f.js"><link rel="prefetch" href="/assets/js/18.e5ce87b6.js"><link rel="prefetch" href="/assets/js/19.0b166866.js"><link rel="prefetch" href="/assets/js/20.fb1850aa.js"><link rel="prefetch" href="/assets/js/21.2997a3f3.js"><link rel="prefetch" href="/assets/js/22.0b836d61.js"><link rel="prefetch" href="/assets/js/23.6982e296.js"><link rel="prefetch" href="/assets/js/24.54312ba1.js"><link rel="prefetch" href="/assets/js/25.26abe02d.js"><link rel="prefetch" href="/assets/js/27.f9457610.js"><link rel="prefetch" href="/assets/js/28.f3873e75.js"><link rel="prefetch" href="/assets/js/29.da7a0da2.js"><link rel="prefetch" href="/assets/js/3.f4742b08.js"><link rel="prefetch" href="/assets/js/30.8da771a8.js"><link rel="prefetch" href="/assets/js/31.b5b7fd08.js"><link rel="prefetch" href="/assets/js/32.2a3ed388.js"><link rel="prefetch" href="/assets/js/33.d69d7cf2.js"><link rel="prefetch" href="/assets/js/34.e9d4f82a.js"><link rel="prefetch" href="/assets/js/35.b066942b.js"><link rel="prefetch" href="/assets/js/36.dd2852de.js"><link rel="prefetch" href="/assets/js/37.a55f022e.js"><link rel="prefetch" href="/assets/js/38.f9c9c15c.js"><link rel="prefetch" href="/assets/js/39.2fe56c0f.js"><link rel="prefetch" href="/assets/js/4.c7f21514.js"><link rel="prefetch" href="/assets/js/40.b2a7aa95.js"><link rel="prefetch" href="/assets/js/41.406997a5.js"><link rel="prefetch" href="/assets/js/42.73cabace.js"><link rel="prefetch" href="/assets/js/43.c391d67d.js"><link rel="prefetch" href="/assets/js/44.cfa42cbd.js"><link rel="prefetch" href="/assets/js/45.0eb52eac.js"><link rel="prefetch" href="/assets/js/46.95ff2b96.js"><link rel="prefetch" href="/assets/js/47.f766527d.js"><link rel="prefetch" href="/assets/js/48.4dac8b69.js"><link rel="prefetch" href="/assets/js/49.f65c572e.js"><link rel="prefetch" href="/assets/js/5.6cf2bb4c.js"><link rel="prefetch" href="/assets/js/6.7729b2aa.js"><link rel="prefetch" href="/assets/js/8.5b1b1b9e.js"><link rel="prefetch" href="/assets/js/9.692124a1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5cc29924.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">King-peach</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Web前端" class="dropdown-title"><span class="title">Web前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="Web前端" class="mobile-dropdown-title"><span class="title">Web前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web/html&amp;css/" class="nav-link">
  HTML+CSS
</a></li><li class="dropdown-item"><!----> <a href="/web/javascript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/web/browser/" class="nav-link">
  浏览器
</a></li><li class="dropdown-item"><!----> <a href="/web/engineering/" class="nav-link">
  前端工程化
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Flutter" class="dropdown-title"><span class="title">Flutter</span> <span class="arrow down"></span></button> <button type="button" aria-label="Flutter" class="mobile-dropdown-title"><span class="title">Flutter</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/flutter/start.html" class="nav-link">
  花上几个小时学习Dart，为Flutter打好基础
</a></li></ul></div></div><div class="nav-item"><a href="/personal/" class="nav-link">
  关于我的
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Web前端" class="dropdown-title"><span class="title">Web前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="Web前端" class="mobile-dropdown-title"><span class="title">Web前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web/html&amp;css/" class="nav-link">
  HTML+CSS
</a></li><li class="dropdown-item"><!----> <a href="/web/javascript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/web/browser/" class="nav-link">
  浏览器
</a></li><li class="dropdown-item"><!----> <a href="/web/engineering/" class="nav-link">
  前端工程化
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Flutter" class="dropdown-title"><span class="title">Flutter</span> <span class="arrow down"></span></button> <button type="button" aria-label="Flutter" class="mobile-dropdown-title"><span class="title">Flutter</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/flutter/start.html" class="nav-link">
  花上几个小时学习Dart，为Flutter打好基础
</a></li></ul></div></div><div class="nav-item"><a href="/personal/" class="nav-link">
  关于我的
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Javascript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML+CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>浏览器</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>前端工程化</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/1970/01/01/engineering/" class="sidebar-link">前端工程化是什么？</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1970/01/01/engineering/#前端工程化的演进" class="sidebar-link">前端工程化的演进</a></li></ul></li><li><a href="/1970/01/01/commit-rule/" aria-current="page" class="active sidebar-link">前端工作流之commit规范及其配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1970/01/01/commit-rule/#为啥要规范git-commit-规范" class="sidebar-link">为啥要规范git commit 规范?</a></li><li class="sidebar-sub-header"><a href="/1970/01/01/commit-rule/#需要的工具及介绍" class="sidebar-link">需要的工具及介绍</a></li></ul></li><li><a href="/1970/01/01/zaozaoliao-devops/" class="sidebar-link">早早聊之如何基于Node做DevOps实践视频总结</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1970/01/01/zaozaoliao-devops/#devops使用的意义" class="sidebar-link">DevOps使用的意义</a></li><li class="sidebar-sub-header"><a href="/1970/01/01/zaozaoliao-devops/#devops定义" class="sidebar-link">DevOps定义</a></li><li class="sidebar-sub-header"><a href="/1970/01/01/zaozaoliao-devops/#node在devops作用" class="sidebar-link">Node在DevOps作用</a></li><li class="sidebar-sub-header"><a href="/1970/01/01/zaozaoliao-devops/#工具推荐" class="sidebar-link">工具推荐</a></li></ul></li><li><a href="/1970/01/01/build-person-blob/" class="sidebar-link">CentOS + Git + Hexo搭建个人博客</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1970/01/01/build-person-blob/#原理" class="sidebar-link">原理</a></li><li class="sidebar-sub-header"><a href="/1970/01/01/build-person-blob/#所需技术介绍" class="sidebar-link">所需技术介绍</a></li><li class="sidebar-sub-header"><a href="/1970/01/01/build-person-blob/#前期准备工作" class="sidebar-link">前期准备工作</a></li><li class="sidebar-sub-header"><a href="/1970/01/01/build-person-blob/#详细搭建流程" class="sidebar-link">详细搭建流程</a></li><li class="sidebar-sub-header"><a href="/1970/01/01/build-person-blob/#服务器部署-并克隆拉取git项目" class="sidebar-link">服务器部署，并克隆拉取Git项目</a></li><li class="sidebar-sub-header"><a href="/1970/01/01/build-person-blob/#总结" class="sidebar-link">总结</a></li></ul></li><li><a href="/1970/01/01/ssh-connect-git/" class="sidebar-link">SSH连接git远程仓库</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1970/01/01/ssh-connect-git/#ssh身份验证过程" class="sidebar-link">SSH身份验证过程</a></li><li class="sidebar-sub-header"><a href="/1970/01/01/ssh-connect-git/#总结" class="sidebar-link">总结</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="前端工作流之commit规范及其配置"><a href="#前端工作流之commit规范及其配置" class="header-anchor">#</a> 前端工作流之commit规范及其配置</h1> <h2 id="为啥要规范git-commit-规范"><a href="#为啥要规范git-commit-规范" class="header-anchor">#</a> 为啥要规范git commit 规范?</h2> <p>当我们的项目体积日益增大以后，我们的 <code>git</code>提交量也会是很大的，如果这时候我们要对曾经的一次提交进行 <code>review</code> 时，通过一次次的提交记录中查看我们的历史提交，是一件很痛苦的事情，因为这些提交信息都没有进行分类，而且也不确定提交信息是否准确
<br> <br>
而一份好的提交记录，会将每次提交的影响范围，内容，以及涉及到的 <code>bug</code>都清晰地展示出来，且格式一直，便于查找。这样对查看代码提交记录或者审查代码的人更友好，能够更好地了解项目的生命周期以及中间出现的问题
<br> <br>
在这里简单介绍下 <code>angular</code> 规范 <code>commit message</code> 写法：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">&lt;</span>type<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>scope<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token operator">&lt;</span>subject<span class="token operator">&gt;</span>

<span class="token comment">// 空一行</span>

<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
 
<span class="token comment">// 空一行</span>

<span class="token operator">&lt;</span>footer<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><br> <ul><li><code>header</code> 部分分为 <code>type</code>、<code>scope</code>、<code>subject</code> <ol><li><code>type</code>：提交类型，包括【 <code>feat</code> | <code>fix</code> | <code>perf</code> | <code>refactor</code> | <code>test</code> | <code>revert</code> | <code>docs</code> | <code>ci</code> | <code>build</code> 】</li> <li><code>scope</code>：表示改动的文件范围，可以写模块-文件</li> <li><code>subject</code>：对这次改动的具体描述，例如：改了xxx <code>bug</code> 或者增加了 xxx 功能</li></ol></li> <li><code>body</code> 部分就是写一下更详细的描述，为可选项</li> <li><code>footer</code> 部分表示如果你的改动是破坏性的比如你写的是插件，大版本升级，把 <code>API</code> 都改了，就需要在这里进行详细描述包括迁移说明</li></ul> <h2 id="需要的工具及介绍"><a href="#需要的工具及介绍" class="header-anchor">#</a> 需要的工具及介绍</h2> <p>我打算使用 <code>commitlint + husky + lint-staged</code> 工具集来约束项目代码的提交，其中 commitlint 是用来约束 <code>git commit message</code>的，<code>husky</code>用来提供 <code>git pre-commit hook</code>做一些事情，而这里我们就是用来拦截 <code>git</code>提交信息，检测是否符合规范，然后再提交。当然在提交之前还可以进行一些其他操作，比如运行 <code>lint</code>一下项目，看是否有不合格的代码，但是每次提交前都 <code>lint</code>完整的项目，那会有点耗时，这对时间宝贵的程序员来说是不合理的，而 <code>lint-staged</code>的作用就是只 <code>lint</code>提交区的代码，这就大大的缩短了提交时间，提升效率。
<br>如果你记不住以上提交规范，可以安装 <code>commitizen ｜cz-conventional-changelog</code>，在提交中增加表情，可以通过 <code>git-cz</code>实现
<br>​
<br></p> <h3 id="工具安装和配置"><a href="#工具安装和配置" class="header-anchor">#</a> 工具安装和配置</h3> <p>首先安装一波 <code>commitlint + husky + lint-staged</code>工具集，使用npm下载依赖的同学可以使用以下命令：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i husky@4.3.8 lint-staged @commitlint/cli @commitlint/config-conventional --dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>使用yarn的同学，使用以下命令：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">yarn</span> <span class="token function">add</span> husky@4.3.8 lint-staged @commitlint/cli @commitlint/config-conventional -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>由于husky6+版本存在比较大的改动，有可能存在不触发 pre-commit 的情况，所以在这里我使用相对稳定的v4.3.8
lint-staged依赖需要运行在node v12.13.0+，所以如果安装后lint-satged报错，就需要将您的node版本升级到12.13.0或更高的版本，如果您需要多node环境切换的话，可以通过<a href="https://www.runoob.com/w3cnote/nvm-manager-node-versions.html" target="_blank" rel="noopener noreferrer">nvm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>工具操作</p></blockquote> <p>需要注意的是，对于commitlint不需要自定义提交规范的，可以直接下载 <code>@commitlint/config-angular</code> 依赖代替
<br><code>@commitlint/config-conventional</code>依赖，关于 <code>angular</code> 提交规范可以参考：<a href="https://github.com/angular/angular.js/blob/master/DEVELOPERS.md#-git-commit-guidelines" target="_blank" rel="noopener noreferrer">AngularJS团队规范<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <br>对于大多数项目来说，<code>angular</code>团队规范应该是够用的，如果需要自定义的话，除了需要安装以上依赖以外，还需要在项目的根目录下新增<code>commitlint.config.js</code>文件，文件内容可以参考如下内容：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@commitlint/config-conventional'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  rules<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'type-enum'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'always'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
      <span class="token string">'feat'</span><span class="token punctuation">,</span> <span class="token comment">// 新功能（feature）</span>
      <span class="token string">'fix'</span><span class="token punctuation">,</span> <span class="token comment">// 修补bug</span>
      <span class="token string">'perf'</span><span class="token punctuation">,</span> <span class="token comment">// 优化 (包括功能、性能优化)</span>
      <span class="token string">'docs'</span><span class="token punctuation">,</span> <span class="token comment">// 文档（documentation）</span>
      <span class="token string">'style'</span><span class="token punctuation">,</span> <span class="token comment">// 格式（不影响代码运行的变动）</span>
      <span class="token string">'refactor'</span><span class="token punctuation">,</span> <span class="token comment">// 重构（即不是新增功能，也不是修改bug的代码变动）</span>
      <span class="token string">'test'</span><span class="token punctuation">,</span> <span class="token comment">// 增加测试</span>
      <span class="token string">'revert'</span><span class="token punctuation">,</span> <span class="token comment">// 回滚</span>
      <span class="token string">'ci'</span><span class="token punctuation">,</span> <span class="token comment">// 构建过程或辅助工具的变动</span>
      <span class="token string">'chore'</span> <span class="token comment">// 其他改动</span>
    <span class="token punctuation">]</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'type-empty'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'never'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'subject-empty'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'never'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'subject-full-stop'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'never'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'subject-case'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'never'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>也可以使用命令行添加此文件：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;module.exports = {extends: ['@commitlint/config-conventional']};&quot;</span> <span class="token operator">&gt;</span> commitlint.config.js
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这种方式添加的文件内容不完整，还需要手动添加一些项，参考上述文件 <code>commitlint.config.js</code> <br>下载完husky后还需要进行初始化，输入以下命令：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>npx <span class="token function">install</span> husky
<span class="token function">npm</span> set-script prepare <span class="token string">&quot;husky install&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>运行完以后，项目根目录下就会出现一个 <code>.husky</code> 文件夹，里面就是 <code>hook shell</code> ，如图所示：
<br><img src="/assets/img/img-1.c452e17e.png" alt="image.png"> <br>接下来我们修改 <code>.husky</code> 目录下的 <code>pre-commit</code> 文件，如下所示：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code>#!/bin/sh
. <span class="token string">&quot;$(dirname &quot;</span>$<span class="token number">0</span><span class="token string">&quot;)/_/husky.sh&quot;</span>

npx lint-staged
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>相应的page.json我们也需要配置一下，在 <code>script</code> 中配置<code>lint</code>运行时：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;serve&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-service serve --open&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-service build&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eslint . --ext .js,.jsx,.ts,.tsx&quot;</span><span class="token punctuation">,</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>在根节点下，添加<code>husky</code> 和 <code>lint-staged</code> 属性：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;husky&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;hooks&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;pre-commit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lint-staged&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;commit-msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;commitlint -E HUSKY_GIT_PARAMS&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token property">&quot;lint-staged&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;*.{js,vue}&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;eslint --fix&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;git add&quot;</span>
    <span class="token punctuation">]</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>这时候，我们进行一下简单的测试，首先故意写一个错误的代码，添加并提交：
<br><img src="/assets/img/img-2.93611444.png" alt="image.png"> <br>项目会进行 <code>lint</code> 出错了，这时提交失败了，我们再尝试一个提交正确的代码，但是输入不规范的<code>git commit message</code> <br><img src="/assets/img/img-3.eaf6121e.png" alt="image.png"> <br>这里出现了 <code>husky</code> 校验提交信息错误，我们再按照标准的提交方式提交
<br><img src="/assets/img/img-4.505a5d5b.png" alt="image.png"> <br><img src="/assets/img/img-5.64d7852f.png" alt="image.png"> <br>这次就提交成功了！
<br>有的同学可能到这里出现husky还是无法触发的情况，可以尝试命令行：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>npx husky <span class="token function">add</span> .husky/commit-msg <span class="token string">'npx --no-install commitlint --edit <span class="token variable">$1</span>'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>到这里我们就配置了一个的完整监控 <code>commit</code> 规范的环境，当然还有更加完善的方案，比如上面提到的增加 commitizen 进行commit 提示，以及 git-cz 添加表情，这块配置我就不赘述了，想了解的同学可以参考：
<br><a href="https://juejin.cn/post/6934292467160514567#heading-7" target="_blank" rel="noopener noreferrer">commit规范+commitlint+CHANGELOG自动生成一条龙服务<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h3> <p>通过配置这套工具，我就可以方便地找到以前的垃圾代码，进行优化或者重构。经过这波配置，让我感受到前端工具的强大，以及前端生态中的有一批大佬为解放生产力而默默耕耘，生命在于折腾，我希望以后自己也能出个类似的工具，造福有需要的人，在前端圈发光发热🤩🤩
<br>​
<br></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">12/15/2021, 6:30:13 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/1970/01/01/engineering/" class="prev">
        前端工程化是什么？
      </a></span> <span class="next"><a href="/1970/01/01/zaozaoliao-devops/">
        早早聊之如何基于Node做DevOps实践视频总结
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.e4cbe0ad.js" defer></script><script src="/assets/js/26.58159373.js" defer></script><script src="/assets/js/1.297c7cf7.js" defer></script><script src="/assets/js/7.a778d25a.js" defer></script>
  </body>
</html>
